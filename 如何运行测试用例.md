# 🚀 如何运行测试用例 - 完整指南

## 📋 第一步：构建可执行文件

你当前没有可执行文件，需要先构建：

### 方法1：快速构建（推荐）
```bash
cd build
python build_cross_platform.py
```

### 方法2：使用现有的Python文件直接运行
```bash
# 直接使用Python文件作为"可执行文件"
python user_behavior_monitor.py
```

## 🎯 第二步：选择运行方式

### 🚀 方式1：运行所有测试用例（推荐）

```bash
cd tests/scripts_windows

# 如果你构建了exe文件
./run_all_improved.sh -ExePath "../../dist/UserBehaviorMonitor.exe" -WorkDir "win_test_run"

# 如果直接使用Python文件
./run_all_improved.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
```

**预计执行时间**: 12-15分钟（超快模式）

### ⚡ 方式2：快速测试（只运行核心用例）

```bash
cd tests/scripts_windows

# 只运行TC02、TC03、TC04核心用例
./quick_test.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
```

**预计执行时间**: 5-8分钟

### 🎯 方式3：运行单个测试用例

```bash
cd tests/scripts_windows

# TC01 - 实时输入采集（30秒）
./TC01_realtime_input_collection.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC02 - 特征提取功能（1分钟）
./TC02_feature_extraction.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC03 - 深度学习分类（2分钟）
./TC03_deep_learning_classification.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC04 - 异常告警（1分钟）
./TC04_anomaly_alert.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC05 - 异常阻止（1分钟）
./TC05_anomaly_block.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC06 - 行为指纹管理（1分钟）
./TC06_behavior_fingerprint_management.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC07 - 采集指标（1分钟）
./TC07_collection_metrics.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC08 - 特征数量阈值（1分钟）
./TC08_feature_count_metric.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC09 - 分类准确率指标（2分钟）
./TC09_classification_accuracy_metric.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"

# TC10 - 异常误报率（2分钟）
./TC10_anomaly_false_alarm_rate.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
```

### 🎨 方式4：运行增强版测试用例（详细输出）

```bash
cd tests/scripts_windows

# 增强版测试用例（输出更详细的实际结果数据）
./TC01_enhanced_realtime_collection.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
./TC02_enhanced_feature_processing.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
./TC03_enhanced_deep_learning_classification.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
# ... 其他增强版测试用例
```

## 📊 第三步：查看测试结果

### 测试执行后会生成：

1. **控制台输出**: 实时显示测试进度和结果
2. **日志文件**: `win_test_run/logs/` 目录下
3. **测试报告**: `win_test_run/reports/` 目录下
4. **数据库文件**: `win_test_run/data/` 目录下

### 生成测试报告：

```bash
cd tests/scripts_windows

# 生成标准格式测试报告
./generate_test_report.sh --results-dir "win_test_run/reports" --start-time "2025-12-15 15:30:00" --end-time "2025-12-15 16:45:30"

# 生成统一格式测试报告
./generate_unified_test_report.sh --results-dir "win_test_run/reports" --start-time "2025-12-15 15:30:00" --end-time "2025-12-15 16:45:30"

# 生成修正版测试报告
./generate_corrected_test_report.sh --results-dir "win_test_run/reports" --start-time "2025-12-15 15:30:00" --end-time "2025-12-15 16:45:30"
```

## 🔧 第四步：常见问题解决

### 问题1: 权限不足
```bash
# 给脚本添加执行权限
chmod +x tests/scripts_windows/*.sh
```

### 问题2: Python依赖缺失
```bash
# 安装依赖
pip install -r requirements.txt
```

### 问题3: 测试脚本找不到
```bash
# 检查当前目录
pwd
# 应该在项目根目录: /Users/jinbozhang/workspace/user-behavior-monitor

# 检查脚本是否存在
ls tests/scripts_windows/TC01_realtime_input_collection.sh
```

### 问题4: 可执行文件路径问题
```bash
# 检查Python是否可用
which python
python --version

# 检查用户行为监控主程序
ls user_behavior_monitor.py
```

## 📈 测试模式对比

| 模式 | 测试用例数量 | 预计时间 | 适用场景 |
|------|-------------|----------|----------|
| **完整测试** | 10个 | 12-15分钟 | 全面验证 |
| **快速测试** | 3个核心 | 5-8分钟 | 快速验证 |
| **单个测试** | 1个 | 30秒-2分钟 | 调试特定功能 |
| **增强版测试** | 10个 | 15-20分钟 | 详细数据输出 |

## 🎯 推荐运行顺序

### 首次运行推荐：
1. 先运行快速测试确认环境正常
2. 再运行完整测试验证所有功能
3. 最后生成测试报告

### 日常开发推荐：
1. 运行相关的单个测试用例
2. 修复问题后运行快速测试
3. 提交前运行完整测试

## 💡 小贴士

1. **超快模式**: 所有脚本默认启用超快模式，大幅减少等待时间
2. **后台运行**: 可以使用 `nohup` 在后台运行长时间测试
3. **并行测试**: 单个测试用例可以并行运行，但要注意端口冲突
4. **结果复用**: 测试结果会保存，可以重复查看和分析

## 🚀 立即开始

**最简单的开始方式**：

```bash
# 进入测试目录
cd /Users/jinbozhang/workspace/user-behavior-monitor/tests/scripts_windows

# 运行快速测试（推荐首次使用）
./quick_test.sh -ExePath "python ../../user_behavior_monitor.py" -WorkDir "win_test_run"
```

这个命令会在5-8分钟内运行核心测试用例，让你快速了解系统状态！
