# 1. 测试用例名称

用户行为数据实时采集功能（黑盒-打包后EXE）

# 2. 测试用例综述

从软件成品角度（打包后的 EXE）验证系统具备对键盘、鼠标等输入设备的实时采集功能：后台持续监听、按配置频率采样、事件正确落库并可追溯。

# 3. 用例初始化

- 已获取打包好的可执行程序（示例：`UserBehaviorMonitor.exe` 或对应平台可执行文件）。
- 创建干净的测试目录（含 `data/`, `logs/`）。
- 确认配置可加载；如支持，通过环境变量或同目录 `config.yaml` 指定数据库：`data/mouse_data.db`。
- 推荐参数（若支持）：`--target-samples 200 --collection-interval 0.1`。

# 4. 前提和约束

- 以具备全局输入监听权限的账户运行（Windows 需允许全局钩子，Linux/Kylin 需 `pynput` 权限）。
- 无安全软件拦截全局输入监听与文件写入；测试期间不要切换用户或注销。
- 若无真实交互，可使用系统脚本自动生成输入（如 PowerShell/xdotool）。

# 5. 测试步骤

| 序号 | 输入及操作 | 期望结果或评估标准 | 实测结果 | 测试结论 |
| --- | --- | --- | --- | --- |
| 1 | 在测试目录启动 EXE（例：`./UserBehaviorMonitor.exe`） | 程序正常启动，`logs/` 产生日志文件 |  |  |
| 2 | 正常移动鼠标 30s，包含若干点击与滚轮 | `data/mouse_data.db` 自动创建；`mouse_events` 表持续新增记录 |  |  |
| 3 | 暂停操作 5s，再继续移动 15s | 事件时间戳单调递增；空闲段事件明显减少 |  |  |
| 4 | 若有 CLI 参数：设置 `--target-samples 200` | 达到目标后采集自动停止或记录里程碑日志 |  |  |
| 5 | 退出程序或结束采集 | 采集线程安全退出，缓冲区数据已落库 |  |  |
| 6 | 检查数据库记录 | 同一 `user_id/session_id` 记录数 ≥ 200；字段 `event_type/button/wheel_delta/x/y` 合法 |  |  |
| 7 | 检查日志 | 含启动、采样间隔、保存批次、停止等关键日志，无 ERROR/CRITICAL |  |  |
